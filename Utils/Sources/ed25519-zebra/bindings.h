/* Warning, this file is auto generated by cbindgen. Don't modify this manually. */

#include <stdarg.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>

typedef struct SigningKey SigningKey;
typedef struct VerificationKey VerificationKey;


/**
 * Creates a new signing key from a 32-byte seed
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_signing_key_from_seed(const uint8_t *seed,
                                       uintptr_t seed_len,
                                       SigningKey **out_ptr);

/**
 * Frees a signing key
 */
void ed25519_signing_key_free(SigningKey *signing_key);

/**
 * Exports signing key to 32 bytes (the seed)
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_signing_key_to_bytes(const SigningKey *signing_key,
                                      uint8_t *out,
                                      uintptr_t out_len);

/**
 * Signs a message with the signing key
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_sign(const SigningKey *signing_key,
                      const uint8_t *message,
                      uintptr_t message_len,
                      uint8_t *signature_out,
                      uintptr_t signature_out_len);

/**
 * Creates a verification key from a signing key
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_verification_key_from_signing_key(const SigningKey *signing_key,
                                                   VerificationKey **out_ptr);

/**
 * Creates a verification key from 32 bytes
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_verification_key_from_bytes(const uint8_t *bytes,
                                             uintptr_t bytes_len,
                                             VerificationKey **out_ptr);

/**
 * Exports verification key to 32 bytes
 * Returns 0 on success, non-zero on error
 */
intptr_t ed25519_verification_key_to_bytes(const VerificationKey *verification_key,
                                           uint8_t *out,
                                           uintptr_t out_len);

/**
 * Frees a verification key
 */
void ed25519_verification_key_free(VerificationKey *verification_key);

/**
 * Verifies a signature using ZIP 215 rules (consensus-critical)
 * Returns 0 on success, non-zero on error
 * Sets `out` to true if signature is valid, false if invalid
 */
intptr_t ed25519_verify(const VerificationKey *verification_key,
                        const uint8_t *signature,
                        uintptr_t signature_len,
                        const uint8_t *message,
                        uintptr_t message_len,
                        bool *out);
